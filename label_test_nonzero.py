#!/usr/bin/env python3
"""
Test case with NON-ZERO pi values to compare performance.
This should be much faster due to better pruning.
"""

import sys
sys.path.insert(0, '/Users/lorenzwagner/Documents/GitHub/bnp-hybrid-scheduling')

# Import all functions from label_test
from label_test import *

# Override pi with non-zero values
pi = {(1, 1): 0.0, (1, 2): 0.0, (1, 3): 0.0, (1, 4): 0.0, (1, 5): 0.0, (1, 6): -2.0, (1, 7): -2.0, (1, 8): 0.0, (1, 9): 0.0, (1, 10): 0.0, (1, 11): 0.0, (1, 12): 0.0, (1, 13): 0.0, (1, 14): 0.0, (1, 15): 0.0, (1, 16): -27.0, (1, 17): 0.0, (1, 18): 0.0, (1, 19): 0.0, (1, 20): 0.0, (1, 21): -27.0, (1, 22): 0.0, (1, 23): 0.0, (1, 24): 0.0, (1, 25): 0.0, (1, 26): 0.0, (1, 27): 0.0, (1, 28): 0.0, (1, 29): 0.0, (1, 30): 0.0, (1, 31): 0.0, (1, 32): 0.0, (1, 33): 0.0, (1, 34): 0.0, (1, 35): 0.0, (1, 36): 0.0, (1, 37): 0.0, (1, 38): 0.0, (1, 39): 0.0, (1, 40): 0.0, (1, 41): 0.0, (1, 42): 0.0, (2, 1): 0.0, (2, 2): -2.0, (2, 3): 0.0, (2, 4): 0.0, (2, 5): 0.0, (2, 6): 0.0, (2, 7): -1.0, (2, 8): -1.0, (2, 9): -1.0, (2, 10): 0.0, (2, 11): 0.0, (2, 12): 0.0, (2, 13): 0.0, (2, 14): 0.0, (2, 15): 0.0, (2, 16): 0.0, (2, 17): 0.0, (2, 18): 0.0, (2, 19): -16.0, (2, 20): 0.0, (2, 21): 0.0, (2, 22): -27.0, (2, 23): 0.0, (2, 24): 0.0, (2, 25): 0.0, (2, 26): 0.0, (2, 27): 0.0, (2, 28): 0.0, (2, 29): 0.0, (2, 30): 0.0, (2, 31): 0.0, (2, 32): 0.0, (2, 33): 0.0, (2, 34): 0.0, (2, 35): 0.0, (2, 36): 0.0, (2, 37): 0.0, (2, 38): 0.0, (2, 39): 0.0, (2, 40): 0.0, (2, 41): 0.0, (2, 42): 0.0, (3, 1): 0.0, (3, 2): -2.0, (3, 3): 0.0, (3, 4): 0.0, (3, 5): 0.0, (3, 6): -1.0, (3, 7): 0.0, (3, 8): 0.0, (3, 9): -2.0, (3, 10): -1.0, (3, 11): 0.0, (3, 12): 0.0, (3, 13): 0.0, (3, 14): 0.0, (3, 15): -16.0, (3, 16): -27.0, (3, 17): 0.0, (3, 18): 0.0, (3, 19): 0.0, (3, 20): 0.0, (3, 21): 0.0, (3, 22): 0.0, (3, 23): -16.0, (3, 24): 0.0, (3, 25): 0.0, (3, 26): 0.0, (3, 27): 0.0, (3, 28): 0.0, (3, 29): 0.0, (3, 30): 0.0, (3, 31): 0.0, (3, 32): 0.0, (3, 33): 0.0, (3, 34): 0.0, (3, 35): 0.0, (3, 36): 0.0, (3, 37): 0.0, (3, 38): 0.0, (3, 39): 0.0, (3, 40): 0.0, (3, 41): 0.0, (3, 42): 0.0}

gamma = {2: 12.0, 6: 27.0, 8: 16.0, 13: 0.0, 15: 0.0, 16: 0.0, 18: 0.0, 19: 0.0, 20: 27.0, 23: 16.0, 28: 0.0, 31: 27.0, 32: 0.0, 35: 0.0, 36: 0.0, 37: 0.0, 38: 8.0, 44: 0.0, 45: 0.0, 47: 0.0, 48: 9.0, 49: 0.0, 50: 10.0, 51: 0.0, 53: 0.0, 54: 10.0, 60: 2.0, 61: 16.0, 64: 9.0, 65: 0.0, 66: 0.0, 67: 0.0, 68: 0.0, 73: 16.0, 74: 0.0, 76: 0.0, 77: 0.0, 78: 0.0, 80: 16.0, 84: 10.0}

if __name__ == "__main__":
    print("="*70)
    print("TEST CASE: NON-ZERO PI VALUES (FAST)")
    print("="*70)
    print("Pi contains non-zero values like -2.0, -27.0, -16.0")
    print("Expected: FAST runtime with aggressive pruning")
    print("="*70)
    print()

    start_time = time.time()

    results = run_labeling_algorithm(
        recipients_r=r_i,
        recipients_s=s_i,
        gamma_dict=gamma,
        obj_mode_dict=obj_mode,
        pi_dict=pi,
        workers=WORKERS,
        max_time=MAX_TIME,
        ms=MS,
        min_ms=MIN_MS,
        theta_lookup=theta_lookup,
        print_worker_selection=False,
        validate_columns=False,
        print_results=True,
        use_bound_pruning=True,
        dominance_mode='bucket',
        max_columns_per_recipient=20,
        branch_constraints={},
        branching_variant='mp',
        n_workers=None
    )

    print(f"\nTotal Runtime: {time.time() - start_time:.4f}s")
